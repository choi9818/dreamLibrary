<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
  	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  	  layout:decorate="~{layouts/layout}">
 <!-- 사용자 스크립트 추가 -->
<th:block layout:fragment="script">
    <script th:inline="javascript">

        $(document).ready(function(){
            $("#searchBtn").on("click",function(e) {
                e.preventDefault();
                page(0);
            });
        });

        function page(page){
            var searchDateType = $("#searchDateType").val();
            var searchBy = $("#searchBy").val();
            var searchQuery = $("#searchQuery").val();

            location.href="/notice/read/" + page + "?searchDateType=" + searchDateType
            + "&searchBy=" + searchBy
            + "&searchQuery=" + searchQuery;
        }
        
    </script>
</th:block>

<!-- 사용자 css 추가 -->
<th:block layout:fragment="css">
	<style>
		@font-face {
			font-family: 'Pretendard';
			font-weight: 300;
			font-display: swap;
			src: local('Pretendard Light'), url('./woff2/Pretendard-Light.woff2') format('woff2'), url('./woff/Pretendard-Light.woff') format('woff');
		}
		#content {
			font-family: 'Pretendard';
			font-weight: 300;
			width: 75%;
			margin: 0 auto;
		}
		#content > h4 {
			text-align: center;
			margin-top: 20px;
			margin-bottom: 40px;
		}
		.table-responsive {
			margin: 20px;
		}
		.table > thead > tr {
			text-align: center;
		}
		#smallSelect { 
			width: 90px; 
			margin-right: 5px; 
			float: left; 
		}
		#smallInput { 
			width: 250px; 
			margin-right: 5px; 
			float: left; 
		}
    </style>
</th:block>
  	  
<div layout:fragment="content" id="content">
  
  <h4>공지사항</h4>
  <!-- Basic Bootstrap Table -->
  <div class="card">
    <div class="table-responsive text-nowrap">
	  <form th:action="@{'/notice/read/'+${readList.number}}" role="form" method="get" th:object="${readList}">
	    
	    <!-- 목록 테이블 -->
		<table class="table">
          <thead>
            <tr>
              <th style="width:5%;">no</th>
              <th style="width:65%;">title</th>
              <th style="width:15%;">writer</th>
              <th style="width:15%;">date</th>
            </tr>
          </thead>
          <tbody class="table-border-bottom-0">
            <!-- list : controller에서 model 객체로 넘겨 받은  -->
            <tr th:each="item, status:${readList.getContent()}">
              <td th:text="${item.id}"></td>
              <td><a th:href="'/notice/view/'+${item.id}" th:text="${item.title}"></a></td>
              <td th:text="${item.createdBy}"></td>
              <td th:text="${#temporals.format(item.regTime, 'yyyy-MM-dd')}"></td>
            </tr><!-- 1row -->                                           
          </tbody>
        </table><br>
                  
	    <!-- 페이지네이션 -->
	    <div th:with="start=${(readList.number/maxPage)*maxPage + 1},
	    			  end=(${(readList.totalPages == 0) ? 1 : 
	    			  (start + (maxPage - 1) < readList.totalPages ? start + (maxPage - 1) : readList.totalPages)})">
	      <nav aria-label="Page navigation">
	        <ul class="pagination justify-content-center pagination-sm">
	          <li class="page-item first" th:classappend="${readList.first}?'disabled'">
	            <a class="page-link" th:onclick="'javascript:page(' + 0 + ')'"><i class="bx bx-chevrons-left"></i></a>
	          </li>
	          <li class="page-item prev" th:classappend="${readList.first}?'disabled'">
	            <a class="page-link" th:onclick="'javascript:page(' + ${readList.number - 1} + ')'"><i class="bx bx-chevron-left"></i></a>
	          </li>
	          <li class="page-item" th:each="page: ${#numbers.sequence(start, end)}"
	          	  th:classappend="${readList.number eq page-1}?'active':''">
	            <a th:onclick="'javascript:page(' + ${page - 1} + ')'" th:inline="text" class="page-link">[[${page}]]</a>
	          </li>
	          <li class="page-item next" th:classappend="${readList.last}?'disabled'">
	            <a class="page-link" th:onclick="'javascript:page(' + ${readList.number + 1} + ')'"><i class="bx bx-chevron-right"></i></a>
	          </li>
	          <li class="page-item last" th:classappend="${readList.last}?'disabled'">
	            <a class="page-link" th:onclick="'javascript:page(' + ${readList.totalPages - 1} + ')'"><i class="bx bx-chevrons-right"></i></a>
	          </li>
	        </ul>
	      </nav>
	    </div>
                  
		<!-- 검색폼  class="form-select form-select-sm form-control id="smallSelect"-->
		<div th:object="${searchDto}" class="pagination justify-content-center">
		  <!-- 기간 -->
		  <select th:field="*{searchDateType}" class="form-select form-select-sm" id="smallSelect">
		    <option value="all">전체기간</option>
            <option value="1d">1일</option>
            <option value="1w">1주</option>
            <option value="1m">1개월</option>
            <option value="6m">6개월</option>
		  </select>
		  <!-- 검색어 -->
		  <select th:field="*{searchBy}" class="form-select form-select-sm" id="smallSelect">
		    <option value="title">제목</option>
            <option value="createdBy">작성자</option>
		  </select>
		  <!-- 입력/버튼 -->
		  <input th:field="*{searchQuery}" type="text" class="form-control form-control-sm" id="smallInput" placeholder="검색어를 입력해주세요">
		  <button id="searchBtn" type="submit" class="btn btn-primary btn-sm">검색</button>
		  <input type="hidden" th:value="${searchDto.searchDateType}" id="searchDateType">
		  <input type="hidden" th:value="${searchDto.searchBy}" id="searchBy">
          <input type="hidden" th:value="${searchDto.searchQuery}" id="searchQuery">
		</div>
	  </form>
    </div>
  </div>
		<!--/ Basic Bootstrap Table -->
</div>
</html>
